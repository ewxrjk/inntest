#! /bin/bash
#
# Configure and start INN
#
# Usage:
#   configure [PATCH ...]
#
# Applies the listed patches to INN's configuration and then starts
# it.
#
set -e
. ./config
for diff; do
    echo "Applying $diff ..."
    ${REALLY} sh -c "cd $PREFIX/etc && patch -p5" < $diff
done
echo start ...
${REALLY} su - tnews -c 'bin/rc.news' > start.log 2>&1
sleep 3                         # let it settle
ctlinnd -s flush ""             # kick main innfeed
